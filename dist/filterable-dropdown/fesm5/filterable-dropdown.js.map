{"version":3,"file":"filterable-dropdown.js","sources":["ng://filterable-dropdown/lib/selection-type.ts","ng://filterable-dropdown/lib/filterable-dropdown.component.ts","ng://filterable-dropdown/lib/multi-select-pipe/multi-select-pipe.ts","ng://filterable-dropdown/lib/filterable-dropdown.module.ts"],"sourcesContent":["export enum SelectionType {\r\n    All = \"Select All\",\r\n    None = \"Select None\"\r\n}  ","import { ChangeDetectorRef, Component, ElementRef, EventEmitter, Input, OnInit, Output, ViewChild } from '@angular/core';\r\nimport { AbstractControl, FormControl, FormGroup } from '@angular/forms';\r\nimport { faCheck } from '@fortawesome/free-solid-svg-icons';\r\nimport { SelectionType } from './selection-type';\r\n\r\nexport interface FilterableItem {\r\n  value: string,\r\n  selected: boolean,\r\n}\r\n\r\n@Component({\r\n  selector: 'bugsplat-filterable-dropdown',\r\n  templateUrl: './filterable-dropdown.component.html',\r\n  styleUrls: ['./filterable-dropdown.component.scss']\r\n})\r\nexport class FilterableDropdownComponent implements OnInit {\r\n\r\n  public faCheck = faCheck;\r\n  public readonly SELECT_ALL = SelectionType.All;\r\n  public readonly SELECT_NONE = SelectionType.None;\r\n\r\n  \r\n  public selectedValues = new Set();\r\n  public selectedItem: string = \"\";\r\n  public filtered = new Set();\r\n\r\n  @Input() autoClose: boolean | \"outside\" | \"inside\" = \"outside\";\r\n\r\n  @Input() items: Array<string> = [];\r\n\r\n  @Input() set selected(selection: string | Array<string>) {\r\n    if (typeof selection === \"string\") {\r\n      this.selectedItem = selection;\r\n    } else if (selection instanceof Array) {\r\n      this.selectedValues = new Set(selection);\r\n    }\r\n  } \r\n\r\n  @Input() disabled: boolean = false;\r\n  @Input() allowMultiSelect: boolean = true;\r\n\r\n  @Output() onItemsSelected: EventEmitter<Array<string> | string> = new EventEmitter<Array<string> | string>();\r\n  @Output() onOpen: EventEmitter<void> = new EventEmitter<void>();\r\n\r\n  @ViewChild('search', { static: true }) search: ElementRef;\r\n  @ViewChild('dropdown', { static: true }) dropdown: ElementRef;\r\n\r\n  public get allowToggleSelectAll(): boolean {\r\n    return (this.allowMultiSelect && this.searchInputValue.length === 0);\r\n  }\r\n\r\n  public get noItemsToDisplay(): boolean {\r\n    return this.filtered.size === 0;\r\n  }\r\n\r\n  nextToggleState: SelectionType = this.SELECT_ALL;\r\n\r\n  searchForm = new FormGroup({\r\n    searchInput: new FormControl()\r\n  });\r\n\r\n  constructor(private changeDetector: ChangeDetectorRef) { }\r\n\r\n\r\n  ngOnInit(): void {\r\n    this.filtered = new Set(this.items);\r\n    this.searchForm.get(\"searchInput\").valueChanges.subscribe(value => {\r\n      if (!value) {\r\n        this.filtered = new Set(this.items);\r\n        return;\r\n      }\r\n  \r\n      const lowerCaseSearchInputValue = value.toLowerCase();\r\n      const filteredValues = this.items.filter(item => item.toLowerCase().indexOf(lowerCaseSearchInputValue) !== -1);\r\n  \r\n      this.filtered = new Set(filteredValues);\r\n    });\r\n  }\r\n\r\n  get selectedItems(): Array<string> | string {\r\n    if (this.allowMultiSelect) {\r\n      let arr: Array<any> = Array.from(this.selectedValues);\r\n      return arr;\r\n    } else {\r\n      return this.selectedItem;\r\n    }\r\n  }\r\n\r\n  onSelectAll(): void {\r\n    this.nextToggleState = this.SELECT_NONE;\r\n    this.selected = this.items;\r\n    this.resetFilterInput();\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n  }\r\n\r\n  onSelectNone(): void {\r\n    this.nextToggleState = this.SELECT_ALL;\r\n    this.selected = [];\r\n    this.resetFilterInput();\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n  }\r\n\r\n  onItemSelect(item: string) {\r\n    if (this.allowMultiSelect) {\r\n      if (this.selectedValues.has(item)){\r\n        this.selectedValues.delete(item);\r\n      } else {\r\n        this.selectedValues.add(item);\r\n      }\r\n    } else {\r\n      this.selectedItem = item;\r\n    }\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n    this.resetFilterInput();\r\n  }\r\n\r\n  onOpenChange(open): void {\r\n    if (open) {\r\n      this.changeDetector.detectChanges();\r\n      this.search.nativeElement.focus();\r\n      this.onOpen.emit();\r\n    }\r\n  }\r\n\r\n  onEnterKeyPressed(): void {\r\n    if (this.allowMultiSelect) {\r\n      this.filtered.forEach(item => {\r\n        if (!this.selectedValues.has(item)) {\r\n          this.selectedValues.add(item);\r\n        }\r\n      });\r\n    } else {\r\n      if (this.filtered && this.filtered.size) {\r\n        this.selectedItem = this.filtered[0];\r\n      } \r\n    }\r\n\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n    this.resetFilterInput();\r\n  }\r\n\r\n  private resetFilterInput(): void {\r\n    this.searchInput.setValue(\"\");\r\n  }\r\n\r\n  public isFiltered(value: string): boolean {\r\n    return this.filtered.has(value);\r\n  }\r\n\r\n  public isSelected(value: string): boolean {\r\n    if (this.allowMultiSelect) {\r\n      return this.selectedValues.has(value)\r\n    } else {\r\n      return value === this.selectedItem;\r\n    }\r\n  }\r\n\r\n  get searchInput(): AbstractControl {\r\n    return this.searchForm.controls[\"searchInput\"];\r\n  }\r\n\r\n  get searchInputValue(): string {\r\n    return this.searchInput.value || \"\";\r\n  }\r\n}","import { PipeTransform, Pipe } from \"@angular/core\";\r\nimport { FilterableItem } from '../filterable-dropdown.component';\r\n\r\n@Pipe({\r\n  name: 'multiSelect'\r\n})\r\nexport class MultiSelectPipe implements PipeTransform {\r\n\r\n  public static readonly ALL_ITEMS_STRING = \"All\";\r\n  public static readonly MULTIPLE_ITEMS_STRING = \"Multiple\";\r\n\r\n  transform(val: Array<string> | string): string {\r\n    if (typeof val === \"string\") {\r\n      if (!val) {\r\n        return MultiSelectPipe.ALL_ITEMS_STRING;\r\n      }\r\n      else {\r\n        return val;\r\n      }\r\n    }\r\n    else if (val instanceof Array) {\r\n      if (val.length === 0) {\r\n        return MultiSelectPipe.ALL_ITEMS_STRING;\r\n      } else if (val.length === 1) {\r\n        return val[0];\r\n      } else {\r\n        return MultiSelectPipe.MULTIPLE_ITEMS_STRING;\r\n      }\r\n    }\r\n  }\r\n}","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { FontAwesomeModule } from '@fortawesome/angular-fontawesome';\r\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\r\nimport { FilterableDropdownComponent } from './filterable-dropdown.component';\r\nimport { MultiSelectPipe } from './multi-select-pipe/multi-select-pipe';\r\n\r\n@NgModule({\r\n  declarations: [FilterableDropdownComponent, MultiSelectPipe],\r\n  imports: [FormsModule,\r\n    ReactiveFormsModule,\r\n    CommonModule,\r\n    NgbModule,\r\n    FontAwesomeModule\r\n  ],\r\n  exports: [FilterableDropdownComponent]\r\n})\r\nexport class FilterableDropdownModule { }\r\n"],"names":[],"mappings":"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"}