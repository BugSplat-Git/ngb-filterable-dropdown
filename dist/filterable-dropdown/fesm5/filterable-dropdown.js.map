{"version":3,"file":"filterable-dropdown.js","sources":["ng://filterable-dropdown/lib/selection-type.ts","ng://filterable-dropdown/lib/filterable-dropdown.component.ts","ng://filterable-dropdown/lib/multi-select-pipe/multi-select-pipe.ts","ng://filterable-dropdown/lib/filterable-dropdown.module.ts"],"sourcesContent":["export enum SelectionType {\r\n    All = \"Select All\",\r\n    None = \"Select None\"\r\n}  ","import { Component, Input, Output, EventEmitter, ViewChild, ElementRef, ChangeDetectorRef } from '@angular/core';\nimport { AbstractControl, FormControl, FormGroup } from '@angular/forms';\nimport { SelectionType } from './selection-type';\nimport { faCheck } from '@fortawesome/free-solid-svg-icons';\nimport { ValueConverter } from '@angular/compiler/src/render3/view/template';\n\nexport interface FilterableItem {\n  value: string,\n  selected: boolean,\n}\n\n@Component({\n  selector: 'bugsplat-filterable-dropdown',\n  templateUrl: './filterable-dropdown.component.html',\n  styleUrls: ['./filterable-dropdown.component.scss']\n})\nexport class FilterableDropdownComponent {\n\n  public faCheck = faCheck;\n  public readonly SELECT_ALL = SelectionType.All;\n  public readonly SELECT_NONE = SelectionType.None;\n\n\n  @Input() autoClose: boolean | \"outside\" | \"inside\" = \"outside\";\n  @Input() items: Array<FilterableItem> = [];\n  @Input() disabled: boolean = false;\n  @Input() allowMultiSelect: boolean = true;\n\n  @Output() onItemsSelected: EventEmitter<Array<string>> = new EventEmitter<Array<string>>();\n  @Output() onOpen: EventEmitter<void> = new EventEmitter<void>();\n\n  @ViewChild('search', { static: true }) search: ElementRef;\n  @ViewChild('dropdown', { static: true }) dropdown: ElementRef;\n\n  public get allowToggleSelectAll(): boolean {\n    return (this.allowMultiSelect && this.searchInputValue.length === 0);\n  }\n\n  public get dropdownItems(): Array<string> {\n    return this.items.map(item=> item.value);\n  }\n\n  public get noItemsToDisplay(): boolean {\n    return this.filteredItems.length === 0;\n  }\n\n  nextToggleState: SelectionType = this.SELECT_ALL;\n\n  searchForm = new FormGroup({\n    searchInput: new FormControl()\n  });\n\n  constructor(private changeDetector: ChangeDetectorRef) { }\n\n  get selectedItems(): Array<string> {\n    const selectedItems =  this.items.filter(item => item.selected === true);\n    return selectedItems.map(item => item.value);\n  }\n\n  onSelectAll(): void {\n    this.items.forEach(item => item.selected = true);\n    this.nextToggleState = this.SELECT_NONE;\n    this.resetFilterInput();\n    this.onItemsSelected.emit(this.selectedItems);\n  }\n\n  onSelectNone(): void {\n    this.items.forEach(item => item.selected = false);\n    this.nextToggleState = this.SELECT_ALL;\n    this.resetFilterInput();\n    this.onItemsSelected.emit(this.selectedItems);\n  }\n\n  onItemSelect(item: FilterableItem) {\n    const itemIndex = this.items.findIndex(value => value.value === item.value);\n    if (itemIndex !== -1) {\n      this.items[itemIndex].selected = !this.items[itemIndex].selected;\n      if (!this.allowMultiSelect) {\n        this.items.forEach(value => {\n          if (value.value != item.value) {\n            value.selected = false;\n          }\n        });\n      }\n      this.onItemsSelected.emit(this.selectedItems);\n    }\n    this.resetFilterInput();\n  }\n\n  onOpenChange(open): void {\n    if (open) {\n      this.changeDetector.detectChanges();\n      this.search.nativeElement.focus();\n      this.onOpen.emit();\n    }\n  }\n\n  onEnterKeyPressed(): void {\n    if (this.allowMultiSelect) {\n      this.filteredItems.forEach(item => {\n        const itemIndex = this.items.indexOf(item)\n        if (itemIndex != -1) {\n          this.items[itemIndex].selected = true;\n        }\n      });\n      this.onItemsSelected.emit(this.selectedItems);\n    } else {\n      if (this.filteredItems.length) {\n        this.onItemSelect(this.filteredItems[0]);\n      }\n    }\n\n    this.resetFilterInput();\n  }\n\n  private resetFilterInput(): void {\n    this.searchInput.setValue(\"\");\n  }\n\n  get filteredItems(): Array<FilterableItem> {\n    if (!this.items) {\n      return [];\n    }\n\n    const lowerCaseSearchInputValue = this.searchInputValue.toLowerCase();\n    return this.items\n      .filter(item => !!item)\n      .filter(item => item.value.toLowerCase().indexOf(lowerCaseSearchInputValue) !== -1);\n  }\n\n  get searchInput(): AbstractControl {\n    return this.searchForm.controls[\"searchInput\"];\n  }\n\n  get searchInputValue(): string {\n    return this.searchInput.value || \"\";\n  }\n\n  isSelected(item: FilterableItem): boolean {\n    if (this.selectedItems && this.selectedItems.length) {\n      const itemIndex = this.items.findIndex(values => values.value == item.value);\n      return this.items[itemIndex].selected;\n    } else {\n      return false;\n    }\n  }\n}","import { PipeTransform, Pipe } from \"@angular/core\";\r\nimport { FilterableItem } from '../filterable-dropdown.component';\r\n\r\n@Pipe({\r\n  name: 'multiSelect'\r\n})\r\nexport class MultiSelectPipe implements PipeTransform {\r\n\r\n  public static readonly ALL_ITEMS_STRING = \"All\";\r\n  public static readonly MULTIPLE_ITEMS_STRING = \"Multiple\";\r\n\r\n  transform(val: Array<string>): string {\r\n    if (val.length === 0) {\r\n      return MultiSelectPipe.ALL_ITEMS_STRING;\r\n    } else if (val.length === 1) {\r\n      return val[0];\r\n    } else {\r\n      return MultiSelectPipe.MULTIPLE_ITEMS_STRING;\r\n    }\r\n  }\r\n}","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { FontAwesomeModule } from '@fortawesome/angular-fontawesome';\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\nimport { FilterableDropdownComponent } from './filterable-dropdown.component';\nimport { MultiSelectPipe } from './multi-select-pipe/multi-select-pipe';\n\n\n\n\n@NgModule({\n  declarations: [FilterableDropdownComponent, MultiSelectPipe],\n  imports: [FormsModule,\n    ReactiveFormsModule,\n    CommonModule,\n    NgbModule,\n    FontAwesomeModule\n  ],\n  exports: [FilterableDropdownComponent]\n})\nexport class FilterableDropdownModule { }\n"],"names":[],"mappings":"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"}