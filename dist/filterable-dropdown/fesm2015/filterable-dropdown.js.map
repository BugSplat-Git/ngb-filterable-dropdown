{"version":3,"file":"filterable-dropdown.js","sources":["ng://filterable-dropdown/lib/selection-type.ts","ng://filterable-dropdown/lib/filterable-dropdown.component.ts","ng://filterable-dropdown/lib/multi-select-pipe/multi-select-pipe.ts","ng://filterable-dropdown/lib/filterable-dropdown.module.ts"],"sourcesContent":["export enum SelectionType {\r\n    All = \"Select All\",\r\n    None = \"Select None\"\r\n}  ","import { Component, Input, Output, EventEmitter, ViewChild, ElementRef, ChangeDetectorRef } from '@angular/core';\nimport { AbstractControl, FormControl, FormGroup } from '@angular/forms';\nimport { SelectionType } from './selection-type';\nimport { faCheck } from '@fortawesome/free-solid-svg-icons';\nimport { ValueConverter } from '@angular/compiler/src/render3/view/template';\n\nexport interface FilterableItem {\n  value: string,\n  selected: boolean,\n}\n\n@Component({\n  selector: 'bugsplat-filterable-dropdown',\n  templateUrl: './filterable-dropdown.component.html',\n  styleUrls: ['./filterable-dropdown.component.scss']\n})\nexport class FilterableDropdownComponent {\n\n  public faCheck = faCheck;\n  public readonly SELECT_ALL = SelectionType.All;\n  public readonly SELECT_NONE = SelectionType.None;\n\n\n  @Input() autoClose: boolean | \"outside\" | \"inside\" = \"outside\";\n  @Input() items: Array<FilterableItem> = [];\n  @Input() disabled: boolean = false;\n  @Input() allowMultiSelect: boolean = true;\n\n  @Output() onItemsSelected: EventEmitter<Array<string>> = new EventEmitter<Array<string>>();\n  @Output() onOpen: EventEmitter<void> = new EventEmitter<void>();\n\n  @ViewChild('search', { static: true }) search: ElementRef;\n  @ViewChild('dropdown', { static: true }) dropdown: ElementRef;\n\n  public get allowToggleSelectAll(): boolean {\n    return (this.allowMultiSelect && this.searchInputValue.length === 0);\n  }\n\n  public get dropdownItems(): Array<string> {\n    return this.items.map(item=> item.value);\n  }\n\n  public get noItemsToDisplay(): boolean {\n    return this.filteredItems.length === 0;\n  }\n\n  nextToggleState: SelectionType = this.SELECT_ALL;\n\n  searchForm = new FormGroup({\n    searchInput: new FormControl()\n  });\n\n  constructor(private changeDetector: ChangeDetectorRef) { }\n\n  get selectedItems(): Array<string> {\n    const selectedItems =  this.items.filter(item => item.selected === true);\n    return selectedItems.map(item => item.value);\n  }\n\n  onSelectAll(): void {\n    this.items.forEach(item => item.selected = true);\n    this.nextToggleState = this.SELECT_NONE;\n    this.resetFilterInput();\n    this.onItemsSelected.emit(this.selectedItems);\n  }\n\n  onSelectNone(): void {\n    this.items.forEach(item => item.selected = false);\n    this.nextToggleState = this.SELECT_ALL;\n    this.resetFilterInput();\n    this.onItemsSelected.emit(this.selectedItems);\n  }\n\n  onItemSelect(item: FilterableItem) {\n    const itemIndex = this.items.findIndex(value => value.value === item.value);\n    if (itemIndex !== -1) {\n      this.items[itemIndex].selected = !this.items[itemIndex].selected;\n      if (!this.allowMultiSelect) {\n        this.items.forEach(value => {\n          if (value.value != item.value) {\n            value.selected = false;\n          }\n        });\n      }\n      this.onItemsSelected.emit(this.selectedItems);\n    }\n    this.resetFilterInput();\n  }\n\n  onOpenChange(open): void {\n    if (open) {\n      this.changeDetector.detectChanges();\n      this.search.nativeElement.focus();\n      this.onOpen.emit();\n    }\n  }\n\n  onEnterKeyPressed(): void {\n    if (this.allowMultiSelect) {\n      this.filteredItems.forEach(item => {\n        const itemIndex = this.items.indexOf(item)\n        if (itemIndex != -1) {\n          this.items[itemIndex].selected = true;\n        }\n      });\n      this.onItemsSelected.emit(this.selectedItems);\n    } else {\n      if (this.filteredItems.length) {\n        this.onItemSelect(this.filteredItems[0]);\n      }\n    }\n\n    this.resetFilterInput();\n  }\n\n  private resetFilterInput(): void {\n    this.searchInput.setValue(\"\");\n  }\n\n  get filteredItems(): Array<FilterableItem> {\n    if (!this.items) {\n      return [];\n    }\n\n    const lowerCaseSearchInputValue = this.searchInputValue.toLowerCase();\n    return this.items\n      .filter(item => !!item)\n      .filter(item => item.value.toLowerCase().indexOf(lowerCaseSearchInputValue) !== -1);\n  }\n\n  get searchInput(): AbstractControl {\n    return this.searchForm.controls[\"searchInput\"];\n  }\n\n  get searchInputValue(): string {\n    return this.searchInput.value || \"\";\n  }\n\n  isSelected(item: FilterableItem): boolean {\n    if (this.selectedItems && this.selectedItems.length) {\n      const itemIndex = this.items.findIndex(values => values.value == item.value);\n      return this.items[itemIndex].selected;\n    } else {\n      return false;\n    }\n  }\n}","import { PipeTransform, Pipe } from \"@angular/core\";\r\nimport { FilterableItem } from '../filterable-dropdown.component';\r\n\r\n@Pipe({\r\n  name: 'multiSelect'\r\n})\r\nexport class MultiSelectPipe implements PipeTransform {\r\n\r\n  public static readonly ALL_ITEMS_STRING = \"All\";\r\n  public static readonly MULTIPLE_ITEMS_STRING = \"Multiple\";\r\n\r\n  transform(val: Array<string>): string {\r\n    if (val.length === 0) {\r\n      return MultiSelectPipe.ALL_ITEMS_STRING;\r\n    } else if (val.length === 1) {\r\n      return val[0];\r\n    } else {\r\n      return MultiSelectPipe.MULTIPLE_ITEMS_STRING;\r\n    }\r\n  }\r\n}","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { FontAwesomeModule } from '@fortawesome/angular-fontawesome';\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\nimport { FilterableDropdownComponent } from './filterable-dropdown.component';\nimport { MultiSelectPipe } from './multi-select-pipe/multi-select-pipe';\n\n\n\n\n@NgModule({\n  declarations: [FilterableDropdownComponent, MultiSelectPipe],\n  imports: [FormsModule,\n    ReactiveFormsModule,\n    CommonModule,\n    NgbModule,\n    FontAwesomeModule\n  ],\n  exports: [FilterableDropdownComponent]\n})\nexport class FilterableDropdownModule { }\n"],"names":[],"mappings":"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"}