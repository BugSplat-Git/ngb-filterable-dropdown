{"version":3,"file":"filterable-dropdown.js","sources":["ng://filterable-dropdown/lib/selection-type.ts","ng://filterable-dropdown/lib/filterable-dropdown.component.ts","ng://filterable-dropdown/lib/multi-select-pipe/multi-select-pipe.ts","ng://filterable-dropdown/lib/filterable-dropdown.module.ts"],"sourcesContent":["export enum SelectionType {\r\n    All = \"Select All\",\r\n    None = \"Select None\"\r\n}  ","import { ChangeDetectorRef, Component, ElementRef, EventEmitter, Input, OnInit, Output, ViewChild } from '@angular/core';\r\nimport { AbstractControl, FormControl, FormGroup } from '@angular/forms';\r\nimport { faCheck } from '@fortawesome/free-solid-svg-icons';\r\nimport { SelectionType } from './selection-type';\r\n\r\nexport interface FilterableItem {\r\n  value: string,\r\n  selected: boolean,\r\n}\r\n\r\n@Component({\r\n  selector: 'bugsplat-filterable-dropdown',\r\n  templateUrl: './filterable-dropdown.component.html',\r\n  styleUrls: ['./filterable-dropdown.component.scss']\r\n})\r\nexport class FilterableDropdownComponent implements OnInit {\r\n\r\n  public faCheck = faCheck;\r\n  public readonly SELECT_ALL = SelectionType.All;\r\n  public readonly SELECT_NONE = SelectionType.None;\r\n\r\n  public selected = new Set();\r\n  public filtered = new Set();\r\n\r\n  @Input() autoClose: boolean | \"outside\" | \"inside\" = \"outside\";\r\n  @Input() items: Array<string> = [];\r\n  @Input() set selectedItems(selection: string | Array<string>) {\r\n    if (typeof selection === \"string\") {\r\n      this.selected = new Set([selection])\r\n    } else {\r\n      this.selected = new Set(selection);\r\n    }\r\n  } \r\n  @Input() disabled: boolean = false;\r\n  @Input() allowMultiSelect: boolean = true;\r\n  @Input() placeholder: string;\r\n\r\n  @Output() onItemsSelected: EventEmitter<Array<string> | string> = new EventEmitter<Array<string> | string>();\r\n  @Output() onOpen: EventEmitter<void> = new EventEmitter<void>();\r\n\r\n  @ViewChild('search', { static: true }) search: ElementRef;\r\n  @ViewChild('dropdown', { static: true }) dropdown: ElementRef;\r\n\r\n  public get allowToggleSelectAll(): boolean {\r\n    return (this.allowMultiSelect && this.searchInputValue.length === 0);\r\n  }\r\n\r\n  public get noItemsToDisplay(): boolean {\r\n    return this.filtered.size === 0;\r\n  }\r\n\r\n  nextToggleState: SelectionType = this.SELECT_ALL;\r\n\r\n  searchForm = new FormGroup({\r\n    searchInput: new FormControl()\r\n  });\r\n\r\n  constructor(private changeDetector: ChangeDetectorRef) { }\r\n\r\n\r\n  ngOnInit(): void {\r\n    this.filtered = new Set(this.items);\r\n    this.searchForm.get(\"searchInput\").valueChanges.subscribe(value => {\r\n      if (!value) {\r\n        this.filtered = new Set(this.items);\r\n        return;\r\n      }\r\n  \r\n      const lowerCaseSearchInputValue = value.toLowerCase();\r\n      const filteredValues = this.items.filter(item => item.toLowerCase().indexOf(lowerCaseSearchInputValue) !== -1);\r\n  \r\n      this.filtered = new Set(filteredValues);\r\n    });\r\n  }\r\n\r\n  get selectedItems(): Array<string> | string {\r\n    let arr: Array<any> = Array.from(this.selected);\r\n    if (this.allowMultiSelect) {\r\n      return arr;\r\n    } else {\r\n      if (arr) {\r\n        return arr[0]\r\n      } else {\r\n        return \"\";\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  onSelectAll(): void {\r\n    this.nextToggleState = this.SELECT_NONE;\r\n    this.selected = new Set(this.items);\r\n    this.resetFilterInput();\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n  }\r\n\r\n  onSelectNone(): void {\r\n    this.nextToggleState = this.SELECT_ALL;\r\n    this.selected = new Set([]);\r\n    this.resetFilterInput();\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n  }\r\n\r\n  onItemSelect(item: string) {\r\n    if (this.allowMultiSelect) {\r\n      if (this.selected.has(item)){\r\n        this.selected.delete(item);\r\n      } else {\r\n        this.selected.add(item);\r\n      }\r\n    } else {\r\n      this.selected = new Set([item]);\r\n    }\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n    this.resetFilterInput();\r\n  }\r\n\r\n  onOpenChange(open): void {\r\n    if (open) {\r\n      this.changeDetector.detectChanges();\r\n      this.search.nativeElement.focus();\r\n      this.onOpen.emit();\r\n    }\r\n  }\r\n\r\n  onEnterKeyPressed(): void {\r\n    if (this.allowMultiSelect) {\r\n      this.filtered.forEach(item => {\r\n        if (!this.selected.has(item)) {\r\n          this.selected.add(item);\r\n        }\r\n      });\r\n    } else {\r\n      if (this.filtered && this.filtered.size) {\r\n        this.selected = new Set([this.filtered[0]]);\r\n      } \r\n    }\r\n\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n    this.resetFilterInput();\r\n  }\r\n\r\n  private resetFilterInput(): void {\r\n    this.searchInput.setValue(\"\");\r\n  }\r\n\r\n  public isFiltered(value: string): boolean {\r\n    return this.filtered.has(value);\r\n  }\r\n\r\n  public isSelected(value: string): boolean {\r\n    return this.selected.has(value);\r\n  }\r\n\r\n  get searchInput(): AbstractControl {\r\n    return this.searchForm.controls[\"searchInput\"];\r\n  }\r\n\r\n  get searchInputValue(): string {\r\n    return this.searchInput.value || \"\";\r\n  }\r\n}","import { PipeTransform, Pipe } from \"@angular/core\";\r\nimport { FilterableItem } from '../filterable-dropdown.component';\r\n\r\n@Pipe({\r\n  name: 'multiSelect'\r\n})\r\nexport class MultiSelectPipe implements PipeTransform {\r\n\r\n  public static readonly ALL_ITEMS_STRING = \"All\";\r\n  public static readonly MULTIPLE_ITEMS_STRING = \"Multiple\";\r\n\r\n  transform(val: Array<string> | string): string {\r\n    if (typeof val === \"string\") {\r\n      if (!val) {\r\n        return MultiSelectPipe.ALL_ITEMS_STRING;\r\n      }\r\n      else {\r\n        return val;\r\n      }\r\n    }\r\n    else if (val instanceof Array) {\r\n      if (val.length === 0) {\r\n        return MultiSelectPipe.ALL_ITEMS_STRING;\r\n      } else if (val.length === 1) {\r\n        return val[0];\r\n      } else {\r\n        return MultiSelectPipe.MULTIPLE_ITEMS_STRING;\r\n      }\r\n    }\r\n  }\r\n}","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { FontAwesomeModule } from '@fortawesome/angular-fontawesome';\r\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\r\nimport { FilterableDropdownComponent } from './filterable-dropdown.component';\r\nimport { MultiSelectPipe } from './multi-select-pipe/multi-select-pipe';\r\n\r\n@NgModule({\r\n  declarations: [FilterableDropdownComponent, MultiSelectPipe],\r\n  imports: [FormsModule,\r\n    ReactiveFormsModule,\r\n    CommonModule,\r\n    NgbModule,\r\n    FontAwesomeModule\r\n  ],\r\n  exports: [FilterableDropdownComponent]\r\n})\r\nexport class FilterableDropdownModule { }\r\n"],"names":[],"mappings":"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"}