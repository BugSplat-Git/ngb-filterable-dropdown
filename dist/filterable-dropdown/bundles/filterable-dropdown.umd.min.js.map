{"version":3,"sources":["ng://filterable-dropdown/lib/selection-type.ts","ng://filterable-dropdown/lib/filterable-dropdown.component.ts","ng://filterable-dropdown/lib/multi-select-pipe/multi-select-pipe.ts","ng://filterable-dropdown/lib/filterable-dropdown.module.ts"],"names":["SelectionType","FilterableDropdownComponent","changeDetector","this","faCheck","SELECT_ALL","SELECT_NONE","selectedValues","Set","selectedItem","filtered","autoClose","items","disabled","allowMultiSelect","onItemsSelected","EventEmitter","onOpen","nextToggleState","searchForm","FormGroup","searchInput","FormControl","Object","defineProperty","prototype","selection","Array","searchInputValue","length","size","ngOnInit","_this","get","valueChanges","subscribe","value","lowerCaseSearchInputValue","toLowerCase","filteredValues","filter","item","indexOf","from","onSelectAll","selected","resetFilterInput","emit","selectedItems","onSelectNone","onItemSelect","has","delete","add","onOpenChange","open","detectChanges","search","nativeElement","focus","onEnterKeyPressed","forEach","setValue","isFiltered","isSelected","controls","Component","args","selector","template","ChangeDetectorRef","Input","Output","ViewChild","static","MultiSelectPipe","transform","val","ALL_ITEMS_STRING","MULTIPLE_ITEMS_STRING","Pipe","name","FilterableDropdownModule","NgModule","declarations","imports","FormsModule","ReactiveFormsModule","CommonModule","NgbModule","FontAwesomeModule","exports"],"mappings":"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","sourcesContent":["export enum SelectionType {\r\n    All = \"Select All\",\r\n    None = \"Select None\"\r\n}  ","import { ChangeDetectorRef, Component, ElementRef, EventEmitter, Input, OnInit, Output, ViewChild } from '@angular/core';\r\nimport { AbstractControl, FormControl, FormGroup } from '@angular/forms';\r\nimport { faCheck } from '@fortawesome/free-solid-svg-icons';\r\nimport { SelectionType } from './selection-type';\r\n\r\nexport interface FilterableItem {\r\n  value: string,\r\n  selected: boolean,\r\n}\r\n\r\n@Component({\r\n  selector: 'bugsplat-filterable-dropdown',\r\n  templateUrl: './filterable-dropdown.component.html',\r\n  styleUrls: ['./filterable-dropdown.component.scss']\r\n})\r\nexport class FilterableDropdownComponent implements OnInit {\r\n\r\n  public faCheck = faCheck;\r\n  public readonly SELECT_ALL = SelectionType.All;\r\n  public readonly SELECT_NONE = SelectionType.None;\r\n\r\n  \r\n  public selectedValues = new Set();\r\n  public selectedItem: string = \"\";\r\n  public filtered = new Set();\r\n\r\n  @Input() autoClose: boolean | \"outside\" | \"inside\" = \"outside\";\r\n\r\n  @Input() items: Array<string> = [];\r\n\r\n  @Input() set selected(selection: string | Array<string>) {\r\n    if (typeof selection === \"string\") {\r\n      this.selectedItem = selection;\r\n    } else if (selection instanceof Array) {\r\n      this.selectedValues = new Set(selection);\r\n    }\r\n  } \r\n\r\n  @Input() disabled: boolean = false;\r\n  @Input() allowMultiSelect: boolean = true;\r\n\r\n  @Output() onItemsSelected: EventEmitter<Array<string> | string> = new EventEmitter<Array<string> | string>();\r\n  @Output() onOpen: EventEmitter<void> = new EventEmitter<void>();\r\n\r\n  @ViewChild('search', { static: true }) search: ElementRef;\r\n  @ViewChild('dropdown', { static: true }) dropdown: ElementRef;\r\n\r\n  public get allowToggleSelectAll(): boolean {\r\n    return (this.allowMultiSelect && this.searchInputValue.length === 0);\r\n  }\r\n\r\n  public get noItemsToDisplay(): boolean {\r\n    return this.filtered.size === 0;\r\n  }\r\n\r\n  nextToggleState: SelectionType = this.SELECT_ALL;\r\n\r\n  searchForm = new FormGroup({\r\n    searchInput: new FormControl()\r\n  });\r\n\r\n  constructor(private changeDetector: ChangeDetectorRef) { }\r\n\r\n\r\n  ngOnInit(): void {\r\n    this.filtered = new Set(this.items);\r\n    this.searchForm.get(\"searchInput\").valueChanges.subscribe(value => {\r\n      if (!value) {\r\n        this.filtered = new Set(this.items);\r\n        return;\r\n      }\r\n  \r\n      const lowerCaseSearchInputValue = value.toLowerCase();\r\n      const filteredValues = this.items.filter(item => item.toLowerCase().indexOf(lowerCaseSearchInputValue) !== -1);\r\n  \r\n      this.filtered = new Set(filteredValues);\r\n    });\r\n  }\r\n\r\n  get selectedItems(): Array<string> | string {\r\n    if (this.allowMultiSelect) {\r\n      let arr: Array<any> = Array.from(this.selectedValues);\r\n      return arr;\r\n    } else {\r\n      return this.selectedItem;\r\n    }\r\n  }\r\n\r\n  onSelectAll(): void {\r\n    this.nextToggleState = this.SELECT_NONE;\r\n    this.selected = this.items;\r\n    this.resetFilterInput();\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n  }\r\n\r\n  onSelectNone(): void {\r\n    this.nextToggleState = this.SELECT_ALL;\r\n    this.selected = [];\r\n    this.resetFilterInput();\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n  }\r\n\r\n  onItemSelect(item: string) {\r\n    if (this.allowMultiSelect) {\r\n      if (this.selectedValues.has(item)){\r\n        this.selectedValues.delete(item);\r\n      } else {\r\n        this.selectedValues.add(item);\r\n      }\r\n    } else {\r\n      this.selectedItem = item;\r\n    }\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n    this.resetFilterInput();\r\n  }\r\n\r\n  onOpenChange(open): void {\r\n    if (open) {\r\n      this.changeDetector.detectChanges();\r\n      this.search.nativeElement.focus();\r\n      this.onOpen.emit();\r\n    }\r\n  }\r\n\r\n  onEnterKeyPressed(): void {\r\n    if (this.allowMultiSelect) {\r\n      this.filtered.forEach(item => {\r\n        if (!this.selectedValues.has(item)) {\r\n          this.selectedValues.add(item);\r\n        }\r\n      });\r\n    } else {\r\n      if (this.filtered && this.filtered.size) {\r\n        this.selectedItem = this.filtered[0];\r\n      } \r\n    }\r\n\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n    this.resetFilterInput();\r\n  }\r\n\r\n  private resetFilterInput(): void {\r\n    this.searchInput.setValue(\"\");\r\n  }\r\n\r\n  public isFiltered(value: string): boolean {\r\n    return this.filtered.has(value);\r\n  }\r\n\r\n  public isSelected(value: string): boolean {\r\n    if (this.allowMultiSelect) {\r\n      return this.selectedValues.has(value)\r\n    } else {\r\n      return value === this.selectedItem;\r\n    }\r\n  }\r\n\r\n  get searchInput(): AbstractControl {\r\n    return this.searchForm.controls[\"searchInput\"];\r\n  }\r\n\r\n  get searchInputValue(): string {\r\n    return this.searchInput.value || \"\";\r\n  }\r\n}","import { PipeTransform, Pipe } from \"@angular/core\";\r\nimport { FilterableItem } from '../filterable-dropdown.component';\r\n\r\n@Pipe({\r\n  name: 'multiSelect'\r\n})\r\nexport class MultiSelectPipe implements PipeTransform {\r\n\r\n  public static readonly ALL_ITEMS_STRING = \"All\";\r\n  public static readonly MULTIPLE_ITEMS_STRING = \"Multiple\";\r\n\r\n  transform(val: Array<string> | string): string {\r\n    if (typeof val === \"string\") {\r\n      if (!val) {\r\n        return MultiSelectPipe.ALL_ITEMS_STRING;\r\n      }\r\n      else {\r\n        return val;\r\n      }\r\n    }\r\n    else if (val instanceof Array) {\r\n      if (val.length === 0) {\r\n        return MultiSelectPipe.ALL_ITEMS_STRING;\r\n      } else if (val.length === 1) {\r\n        return val[0];\r\n      } else {\r\n        return MultiSelectPipe.MULTIPLE_ITEMS_STRING;\r\n      }\r\n    }\r\n  }\r\n}","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { FontAwesomeModule } from '@fortawesome/angular-fontawesome';\r\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\r\nimport { FilterableDropdownComponent } from './filterable-dropdown.component';\r\nimport { MultiSelectPipe } from './multi-select-pipe/multi-select-pipe';\r\n\r\n@NgModule({\r\n  declarations: [FilterableDropdownComponent, MultiSelectPipe],\r\n  imports: [FormsModule,\r\n    ReactiveFormsModule,\r\n    CommonModule,\r\n    NgbModule,\r\n    FontAwesomeModule\r\n  ],\r\n  exports: [FilterableDropdownComponent]\r\n})\r\nexport class FilterableDropdownModule { }\r\n"]}