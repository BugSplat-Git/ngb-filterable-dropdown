{"version":3,"file":"filterable-dropdown.umd.js","sources":["ng://filterable-dropdown/lib/selection-type.ts","ng://filterable-dropdown/lib/filterable-dropdown.component.ts","ng://filterable-dropdown/lib/multi-select-pipe/multi-select-pipe.ts","ng://filterable-dropdown/lib/filterable-dropdown.module.ts"],"sourcesContent":["export enum SelectionType {\r\n    All = \"Select All\",\r\n    None = \"Select None\"\r\n}  ","import { ChangeDetectorRef, Component, ElementRef, EventEmitter, Input, OnInit, Output, ViewChild } from '@angular/core';\r\nimport { AbstractControl, FormControl, FormGroup } from '@angular/forms';\r\nimport { faCheck } from '@fortawesome/free-solid-svg-icons';\r\nimport { SelectionType } from './selection-type';\r\n\r\nexport interface FilterableItem {\r\n  value: string,\r\n  selected: boolean,\r\n}\r\n\r\n@Component({\r\n  selector: 'bugsplat-filterable-dropdown',\r\n  templateUrl: './filterable-dropdown.component.html',\r\n  styleUrls: ['./filterable-dropdown.component.scss']\r\n})\r\nexport class FilterableDropdownComponent implements OnInit {\r\n\r\n  public faCheck = faCheck;\r\n  public readonly SELECT_ALL = SelectionType.All;\r\n  public readonly SELECT_NONE = SelectionType.None;\r\n\r\n  \r\n  public selectedValues = new Set();\r\n  public selectedItem: string = \"\";\r\n  public filtered = new Set();\r\n\r\n  @Input() autoClose: boolean | \"outside\" | \"inside\" = \"outside\";\r\n\r\n  @Input() items: Array<string> = [];\r\n\r\n  @Input() set selected(selection: string | Array<string>) {\r\n    if (typeof selection === \"string\") {\r\n      this.selectedItem = selection;\r\n    } else if (selection instanceof Array) {\r\n      this.selectedValues = new Set(selection);\r\n    }\r\n  } \r\n\r\n  @Input() disabled: boolean = false;\r\n  @Input() allowMultiSelect: boolean = true;\r\n\r\n  @Output() onItemsSelected: EventEmitter<Array<string> | string> = new EventEmitter<Array<string> | string>();\r\n  @Output() onOpen: EventEmitter<void> = new EventEmitter<void>();\r\n\r\n  @ViewChild('search', { static: true }) search: ElementRef;\r\n  @ViewChild('dropdown', { static: true }) dropdown: ElementRef;\r\n\r\n  public get allowToggleSelectAll(): boolean {\r\n    return (this.allowMultiSelect && this.searchInputValue.length === 0);\r\n  }\r\n\r\n  public get noItemsToDisplay(): boolean {\r\n    return this.filtered.size === 0;\r\n  }\r\n\r\n  nextToggleState: SelectionType = this.SELECT_ALL;\r\n\r\n  searchForm = new FormGroup({\r\n    searchInput: new FormControl()\r\n  });\r\n\r\n  constructor(private changeDetector: ChangeDetectorRef) { }\r\n\r\n\r\n  ngOnInit(): void {\r\n    this.filtered = new Set(this.items);\r\n    this.searchForm.get(\"searchInput\").valueChanges.subscribe(value => {\r\n      if (!value) {\r\n        this.filtered = new Set(this.items);\r\n        return;\r\n      }\r\n  \r\n      const lowerCaseSearchInputValue = value.toLowerCase();\r\n      const filteredValues = this.items.filter(item => item.toLowerCase().indexOf(lowerCaseSearchInputValue) !== -1);\r\n  \r\n      this.filtered = new Set(filteredValues);\r\n    });\r\n  }\r\n\r\n  get selectedItems(): Array<string> | string {\r\n    if (this.allowMultiSelect) {\r\n      let arr: Array<any> = Array.from(this.selectedValues);\r\n      return arr;\r\n    } else {\r\n      return this.selectedItem;\r\n    }\r\n  }\r\n\r\n  onSelectAll(): void {\r\n    this.nextToggleState = this.SELECT_NONE;\r\n    this.selected = this.items;\r\n    this.resetFilterInput();\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n  }\r\n\r\n  onSelectNone(): void {\r\n    this.nextToggleState = this.SELECT_ALL;\r\n    this.selected = [];\r\n    this.resetFilterInput();\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n  }\r\n\r\n  onItemSelect(item: string) {\r\n    if (this.allowMultiSelect) {\r\n      if (this.selectedValues.has(item)){\r\n        this.selectedValues.delete(item);\r\n      } else {\r\n        this.selectedValues.add(item);\r\n      }\r\n    } else {\r\n      this.selectedItem = item;\r\n    }\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n    this.resetFilterInput();\r\n  }\r\n\r\n  onOpenChange(open): void {\r\n    if (open) {\r\n      this.changeDetector.detectChanges();\r\n      this.search.nativeElement.focus();\r\n      this.onOpen.emit();\r\n    }\r\n  }\r\n\r\n  onEnterKeyPressed(): void {\r\n    if (this.allowMultiSelect) {\r\n      this.filtered.forEach(item => {\r\n        if (!this.selectedValues.has(item)) {\r\n          this.selectedValues.add(item);\r\n        }\r\n      });\r\n    } else {\r\n      if (this.filtered && this.filtered.size) {\r\n        this.selectedItem = this.filtered[0];\r\n      } \r\n    }\r\n\r\n    this.onItemsSelected.emit(this.selectedItems);\r\n    this.resetFilterInput();\r\n  }\r\n\r\n  private resetFilterInput(): void {\r\n    this.searchInput.setValue(\"\");\r\n  }\r\n\r\n  public isFiltered(value: string): boolean {\r\n    return this.filtered.has(value);\r\n  }\r\n\r\n  public isSelected(value: string): boolean {\r\n    if (this.allowMultiSelect) {\r\n      return this.selectedValues.has(value)\r\n    } else {\r\n      return value === this.selectedItem;\r\n    }\r\n  }\r\n\r\n  get searchInput(): AbstractControl {\r\n    return this.searchForm.controls[\"searchInput\"];\r\n  }\r\n\r\n  get searchInputValue(): string {\r\n    return this.searchInput.value || \"\";\r\n  }\r\n}","import { PipeTransform, Pipe } from \"@angular/core\";\r\nimport { FilterableItem } from '../filterable-dropdown.component';\r\n\r\n@Pipe({\r\n  name: 'multiSelect'\r\n})\r\nexport class MultiSelectPipe implements PipeTransform {\r\n\r\n  public static readonly ALL_ITEMS_STRING = \"All\";\r\n  public static readonly MULTIPLE_ITEMS_STRING = \"Multiple\";\r\n\r\n  transform(val: Array<string> | string): string {\r\n    if (typeof val === \"string\") {\r\n      if (!val) {\r\n        return MultiSelectPipe.ALL_ITEMS_STRING;\r\n      }\r\n      else {\r\n        return val;\r\n      }\r\n    }\r\n    else if (val instanceof Array) {\r\n      if (val.length === 0) {\r\n        return MultiSelectPipe.ALL_ITEMS_STRING;\r\n      } else if (val.length === 1) {\r\n        return val[0];\r\n      } else {\r\n        return MultiSelectPipe.MULTIPLE_ITEMS_STRING;\r\n      }\r\n    }\r\n  }\r\n}","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { FontAwesomeModule } from '@fortawesome/angular-fontawesome';\r\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\r\nimport { FilterableDropdownComponent } from './filterable-dropdown.component';\r\nimport { MultiSelectPipe } from './multi-select-pipe/multi-select-pipe';\r\n\r\n@NgModule({\r\n  declarations: [FilterableDropdownComponent, MultiSelectPipe],\r\n  imports: [FormsModule,\r\n    ReactiveFormsModule,\r\n    CommonModule,\r\n    NgbModule,\r\n    FontAwesomeModule\r\n  ],\r\n  exports: [FilterableDropdownComponent]\r\n})\r\nexport class FilterableDropdownModule { }\r\n"],"names":["faCheck","EventEmitter","FormGroup","FormControl","Component","ChangeDetectorRef","Input","Output","ViewChild","Pipe","NgModule","FormsModule","ReactiveFormsModule","CommonModule","NgbModule","FontAwesomeModule"],"mappings":"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"}